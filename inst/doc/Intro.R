## ------------------------------------------------------------------------
data("prostate",package="contamDE")
dim(prostate)

## ------------------------------------------------------------------------
head(prostate)

## ----eval=FALSE----------------------------------------------------------
#  d <- contamDE(prostate[,-1],R=2,match=TRUE)

## ----eval=FALSE----------------------------------------------------------
#  names(d)

## ----eval=FALSE----------------------------------------------------------
#  ## [1] "W"  "LR"

## ----eval=FALSE----------------------------------------------------------
#  d$W

## ----eval=FALSE----------------------------------------------------------
#  ## [1] 1.3078678 0.8623965 1.0131880 1.0174180 1.2064407 0.5894919 1.1149573
#  ## [2] 0.9509469 1.1295711 1.2578447 0.7663290 0.6022404 1.2513781 0.9299297

## ----eval=FALSE----------------------------------------------------------
#  head(d$LR)

## ----eval=FALSE----------------------------------------------------------
#  ##             lrt      p.value      logFC
#  ## [1,] 21.8686383 2.919668e-06 -1.7268079
#  ## [2,]  2.4070003 1.207936e-01 -0.8302164
#  ## [3,]  2.7050280 1.000323e-01 -0.6706763
#  ## [4,]  0.1693806 6.806629e-01 -0.3048375
#  ## [5,]  9.3975734 2.172728e-03 -1.2926252
#  ## [6,] 16.7616779 4.238062e-05 -1.5243291

## ------------------------------------------------------------------------
data("drosophila",package="contamDE")
dim(drosophila)
head(drosophila)

## ----eval=FALSE----------------------------------------------------------
#  d <- contamDE(drosophila[,-1],R=2,n=list(1:4,5:7),match=FALSE)

## ----eval=FALSE----------------------------------------------------------
#  d$W

## ----eval=FALSE----------------------------------------------------------
#  ## [1] 0.9743470 0.9818007 1.0438522

## ----eval=FALSE----------------------------------------------------------
#  ##               lrt      p.value        logFC
#  ## [1,] 2.177926e-05 0.9962764259  0.001030783
#  ## [2,] 1.959686e+00 0.1615468840 -0.256221146
#  ## [3,] 2.335351e-01 0.6289148683 -0.085454006
#  ## [4,] 2.098455e-01 0.6468885017 -0.087014070
#  ## [5,] 1.495160e+00 0.2214175509  0.242913855
#  ## [6,] 1.284316e+01 0.0003387145  0.618098952

## ----echo=FALSE----------------------------------------------------------
library(contamDE)

## ----message=FALSE, warning=FALSE----------------------------------------
data("simcounts")
dim(simcounts)
head(simcounts)

## ----message=FALSE, warning=FALSE----------------------------------------
d <- contamDE.lm(simcounts)

## ------------------------------------------------------------------------
names(d)

## ------------------------------------------------------------------------
head(d$p.contamDE.lm)

## ------------------------------------------------------------------------
d$proportion

## ------------------------------------------------------------------------
head(d$log2FC)

## ------------------------------------------------------------------------
subtype <- c(rep("Type1",4),rep("Type2",2),rep("Type3",2))
d <- contamDE.lm(simcounts,subtype)
names(d)

## ------------------------------------------------------------------------
head(d$p.contamDE.lm)

## ------------------------------------------------------------------------
d$proportion

## ------------------------------------------------------------------------
head(d$log2FC)

## ----eval=FALSE----------------------------------------------------------
#  contamDE.lm.test(d,H,b=NULL)

## ------------------------------------------------------------------------
H <- diag(3)
H

## ------------------------------------------------------------------------
H <- matrix(c(1,-1,0),1,3);
H

## ----message=FALSE, warning=FALSE----------------------------------------
subtype <- c(rep("Type1",4),rep("Type2",2),rep("Type3",2))
d <- contamDE.lm(simcounts,subtype)
H <- diag(3)
d1 <- contamDE.lm.test(d,H)

## ------------------------------------------------------------------------
names(d1)

## ------------------------------------------------------------------------
head(d1$p.contamDE.lm.test)

